<?phpclass ApiFbLikesTable extends Table{	protected $table	= 'api_fb_likes';	protected $fields = array(		'id'			=> 'id',		'fk_user_id'	=> 'fk_user_id',		'fk_moment_id'	=> 'fk_moment_id',		'like'			=> 'like',		'useragent'		=> 'useragent',		'ip'			=> 'ip',		'host'			=> 'host',		'session_id'	=> 'session_id',		'created'		=> 'created',				'username'		=> '(SELECT username FROM users WHERE users.id = fk_user_id)',	);	public function getMomentLikes($moment_id)	{		$where = sprintf("`fk_moment_id` = %d", $moment_id);		return $this->_get(null, $where);	}	public function countMomentLikes($moment_id)	{		$numLikes 	= $this->_count(printf("`fk_moment_id` = %d AND `like` = %d ", $moment_id, 1));		$numUnlikes = $this->_count(printf("`fk_moment_id` = %d AND `like` = %d ", $moment_id, 0));		return ($numLikes - $numUnlikes);	}			public function like($user_id, $moment_id)	{		$fields = array(			'like'			=> 1,			'fk_user_id'	=> $user_id,			'fk_moment_id'	=> $moment_id,			'useragent'		=> $_SERVER['HTTP_USER_AGENT'],			'ip'			=> $_SERVER['REMOTE_ADDR'],			'host'			=> gethostbyaddr($_SERVER['REMOTE_ADDR']),			'session_id'	=> Session::getId(),		);		return $this->_add($fields);	}	// TODO: need ajax call for this	public function unLike($user_id, $moment_id)	{		$fields = array(			'like'			=> 0,			'fk_user_id'	=> $user_id,			'fk_moment_id'	=> $moment_id,			'useragent'		=> $_SERVER['HTTP_USER_AGENT'],			'ip'			=> $_SERVER['REMOTE_ADDR'],			'host'			=> gethostbyaddr($_SERVER['REMOTE_ADDR']),			'session_id'	=> Session::getId(),		);		return $this->_add($fields);	}}?>